# Data Standards
This directory contains data standards for all morphology wrappers. Data
standards are program configurations and constraints which are not expected to
change frequently.


# GalWrap
## Filesystem Structure
This section details the organization and structure of the filesystem used by
GalWrap. 

The program operates in three data stages - input, products, and output. Input
files are downloaded directly from the [JWST Mosaics
index](https://s3.amazonaws.com/grizli-v2/JwstMosaics/v7/index.html), and
expected to be organized as specified. Product and output files and directories
are generated by the program.


### Legend
|Letter|Variable|Description|Example|
|:---|:---|:---|:---|
|`F`|`field`|Center of cluster/field instrument is pointed at.|`abell2744clu`|
|`I`|`image_version`|Image processing version.|`grizli-v7.2`|
|`C`|`catalog_version`|Catalog version.|`DJA-v7.2`|
|`L`|`filter`|Observational filter band.|`f140w`|
|`O`|`object`|Integer ID of galaxy in catalog.|`1003`|

### Filesystem Tree
```
jhive_galwrap/
├── input/
│   ├── psfs/
│   │   └── PSF_NIRCam_in_flight_opd_filter_{L}.fits
│   └── {F}/
│       └── {I}/
│           ├── {F}-{I}-ir_seg.fits.gz
│           ├── {F}-{I}-fix_phot_apcorr.fits
│           └── {L}/
│               ├── {F}-{I}-{L}_dr[c/z]_exp.fits.gz
│               ├── {F}-{I}-{L}_dr[c/z]_sci.fits.gz
│               └── {F}-{I}-{L}_dr[c/z]_wht.fits.gz
├── products/
│   ├── default.constraints
│   ├── template.feedfile
│   ├── psfs/
│   │   └── {L}_{P}_psf.fits
│   └── {F}/
│       └── {I}/
│           └── {C}/
│               └── {L}/
│                   └── {O}/
│                       ├── {F}_{I}_{C}_{L}_{O}.feedfile
│                       ├── {F}_{I}_{C}_{L}_{O}_stamp.fits
│                       ├── {F}_{I}_{C}_{L}_{O}_sigma.fits
│                       └── {F}_{I}_{C}_{O}_mask.fits
└── output/
    └── {F}/
        └── {I}/
            └── {C}/
                └── {L}/
                    └── {O}/
                        ├── {F}_{I}_{C}_{L}_{O}_model.fits
                        └── plots/
                            └── {F}_{I}_{C}_{L}_{O}_comparison.png
```


### Translation
<table>
<tr>
<th>
In Filesystem
</th>
<th>
In Program
</th>
</tr>

<tr>
<td>
<pre>
jhive_galwrap/
├── input/
│   ├── psfs/
│   │   └── PSF_NIRCam_in_flight_opd_filter_L.fits
│   └── F/
│       └── I/
│           ├── F-I-ir_seg.fits.gz
│           ├── F-I-fix_phot_apcorr.fits
│           └── L/
│               ├── F-I-L_dr[c/z]_exp.fits.gz
│               ├── F-I-L_dr[c/z]_sci.fits.gz
│               └── F-I-L_dr[c/z]_wht.fits.gz
├── products/
│   ├── default.constraints
│   ├── template.feedfile
│   ├── psfs/
│   │   └── L_P_psf.fits
│   └── F/
│       └── I/
│           └── C/
│               └── L/
│                   └── O/
│                       ├── F_I_C_L_O.feedfile
│                       ├── F_I_C_L_O_stamp.fits
│                       ├── F_I_C_L_O_sigma.fits
│                       └── F_I_C_O_mask.fits
└── output/
    └── F/
        └── I/
            └── C/
                └── L/
                    └── O/
                        ├── F_I_C_L_O_model.fits
                        └── plots/
                            └── F_I_C_L_O_comparison.png
</pre>
</td>

<td>
<pre>
galwrap_root/
├── input_root/
│   ├── input_psfs/
│   │   └── rawpsf
│   └── .../
│       └── input_imver/
│           ├── segmap
│           ├── catalog
│           └── input_images/
│               ├── exposure
│               ├── science
│               └── weights
├── product_root/
│   ├── constraints
│   ├── template
│   ├── product_psfs/
│   │   └── psf
│   └── .../
│       └── .../
│           └── .../
│               └── .../
│                   └── product_ficlo/
│                       ├── feedfile
│                       ├── stamp
│                       ├── sigma
│                       └── mask
└── output_root/
    └── .../
        └── .../
            └── .../
                └── .../
                    └── output_ficlo/
                        ├── model
                        └── output_plots/
                            └── comparison
</pre>
</td>
</tr>
</table>


### Breakdown
|:information_source:|Stage|Path Name|Description|
|:---:|:---|:---|:---|
|:file_folder:|Input|`galwrap_root`|Root directory for all GalWrap files. Note that not all of input, product, and output roots must share a common root.|
|:file_folder:|Input|`input_root`|Root directory for all input files.|
|:file_folder:|Input|`input_psfs`|Directory containing input PSFs as [downloaded from STScI](https://stsci.app.box.com/v/jwst-simulated-psf-library).|
|:framed_picture:|Input|`rawpsf`|Simulated PSF for corresponding NIRCAM filter.|
|:file_folder:|Input|`input_imver`|Directory containing files for a given field and image version.|
|:framed_picture:|Input|`segmap`|Segmentation map for a given field and image version.|
|:framed_picture:|Input|`catalog`|Photometry table catalog FITS file for a given field and image version.|
|:file_folder:|Input|`input_images`|Directory containing input images as [downloaded from JWST](https://s3.amazonaws.com/grizli-v2/JwstMosaics/v7/index.html).|
|:framed_picture:|Input|`exposure`|Exposure map FITS file.|
|:framed_picture:|Input|`science`|Science frame FITS file.|
|:framed_picture:|Input|`weights`|Weights map FITS file.|
|:file_folder:|Product|`product_root`|Root directory for all middle stage generated products.|
|:pencil:|Product|`constraints`|Default constraints file.|
|:pencil:|Product|`template`|Template GALFIT feedfile to be overwritten with data for each object.|
|:file_folder:|Product|`product_psfs`|Directory containing cropped PSFs.|
|:framed_picture:|Product|`psf`|Cropped PSF file given a filter and pixel scale.|
|:file_folder:|Product|`product_ficlo`|Directory containing files for a given field, image version, catalog version, filter, and object (FICLO).|
|:pencil:|Product|`feedfile`|Configurations for a single GALFIT run for a given FICLO.|
|:framed_picture:|Product|`stamp`|Cropped science frame for a given object matched against a catalog.|
|:framed_picture:|Product|`sigma`|Cropped sigma map for a given object from its exposure and weight maps.|
|:framed_picture:|Product|`mask`|Cropped mask frame for a given object given its segmentation map.|
|:file_folder:|Output|`output_root`|Root directory for all output files.|
|:file_folder:|Output|`output_ficlo`|Directory containing files for a given FICLO.|
|:framed_picture:|Output|`model`|Morphology fit model FITS file for a given FICLO.|
|:file_folder:|Output|`output_plots`|Directory containing visualization plots for a given FICLO.|
|:bar_chart:|Output|`comparison`|Model fidelity comparison plot.|